# 网页逻辑

## 1. 详情页查看限制

####1. 搜索列表中点击查看

    总是弹框
    若尚有额度，弹框确认后进入
    无额度，弹框提示后，不予查看

####2. 链接直接查看

    用户在近几天之内，有[推广查看]的，允许直接查看详情
    用户在近几天之内，有[使用额度查看]的，允许直接查看详情
    额度用完的，跳转到其它页面

## 2. 推广机制

    每次推广产生一个 hash, 相当于票据，可以直接查看详情
    用户点击该推广，后台将产生一个记录，这个记录，将使得该用户在近几天之内可以任意浏览该详情
    用户点击该推广，后台将产生一个被推广记录，用于验证推广效果



### 2. 计数模块(use-records)

#### 2.1. 通用计数服务 - 数据结构

    `time`  : 使用时间
    `uid`   : 用户id
    `k1`    : 分类1
    `k2`    : 分类2
    `v1`    : 主值
    `v2`    : 次值
    `n`     : 使用数量
    `json`  : 其它数据


#### 2.2. 通用计数服务 - 接口

1. `select(field, where)`根据条件，模拟 medoo，获取数据
1. `add(条件, 数量)`
1. `record(数据)`
    
#### 2.3. 推广 产能/项目

##### 2.3.1. 推广时

    `time`  : 使用时间
    `uid`   : 用户id
    `k1`    : 'steefac'/'steeproj'
    `k2`    : '推广'
    `v1`    : facid
    `v2`    : hash
    `n`     : 推广到的用户数量
    `json`  : 其它数据

##### 2.3.2. 推广查看

    `time`  : 使用时间
    `uid`   : 用户id
    `k1`    : 'steefac'/'steeproj'
    `k2`    : '推广'
    `v1`    : facid
    `v2`    : hash
    `n`     : 1
    `json`  : 其它数据


    用户点击推广链接后，

    

#### 2.4. 详情查看 产能/项目

    `time`  : 使用时间
    `uid`   : 用户id
    `k1`    : 'steefac'/'steeproj'
    `k2`    : '详情查看'
    `v1`    : facid
    `v2`    : 公司名称
    `json`  : 其它数据

#### 2.5. 一般浏览记录

    `time`  : 使用时间
    `uid`   : 用户id
    `k1`    : 页面
    `k2`    : 参数
    `v1`    : 
    `v2`    : 
    `json`  : 


### 3.权限模块

#### 3.1. 通用权限服务

    `module`: 模块名称
    `uid`   : 用户id
    `type`  : 权限类型
    `name`  : 权限名称
    `t1`    : 生效日期
    `t2`    : 失效日期


#### 3.2. 角色管理

    `module`: 模块名称
    `uid`   :  'role'
    `type`  : 角色名称
    `name`  : 拥有的权限
    `t1`    : 生效日期
    `t2`    : 失效日期
    
    






